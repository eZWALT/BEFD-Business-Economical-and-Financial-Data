x = 2
y = 32
x + y
# Dimension 1 vs others
plot.PCA(res_pca, choix="ind", axes=c(1, 2), main="Dim 1 vs Dim 2")
rm(list=ls())
euroleague_23_24 <- read.csv2("euroleague_23_24.csv")
df <- euroleague_23_24[,-1]
min_column = df[,6]
min_column_splited = strsplit(min_column,split=':',fixed=TRUE)
aux <- sapply(min_column_splited, function(x) {
as.numeric(x[1]) * 60 + as.numeric(x[2]) + as.numeric(x[3]) / 60
})
df<- data.frame(Aux = aux, df[,])
# No acabo de entendre si un cop afegit la columna aux s'ha de borra la columna antiga de MIN
games_played <- df[,5]
min2 <- aux/games_played
df <- data.frame(df[,1], Min2 = min2, df[,-1])
str(df)
df$TEAM <- as.factor(df$TEAM)
df$PLAYER<- as.factor(df$PLAYER)
df$POSITION <- as.factor(df$POSITION)
df$GP <- as.numeric(df$GP)
df$GS <- as.numeric(df$GS)
df <- df[,-8] # I delete the column of Min with a String format
str(df)
library(FactoMineR)
categ_vars <- c("TEAM", "PLAYER", "POSITION")
res_pca <- PCA(df, scale.unit = TRUE, graph=FALSE,
quali.sup = which(names(df) %in% categ_vars),
quanti.sup = which(names(df) == "PIR"))
plot(res_pca)
#See eigenvalues great than 1
res_pca$eig
which(res_pca$eig[,1] > 1)
#How many components are needed for 67%?
which(res_pca$eig[,3] > 67)[1]
#How many components are needed for 80%?
which(res_pca$eig[,3] > 80)[1]
#Compute Scree plot
plot(res_pca$eig[,2], type="o", main="Scree Plot: Percentage of Variance by Component", xlab="Number of components", ylab="Percentage of variance", col="blue", pch=16, xaxt="n", yaxt="n")
axis(1, at=1:length(res_pca$eig[,2]), labels=1:length(res_pca$eig[,2]), las=1)
axis(2, las=1)
loadings <- res_pca$var$coord
dim_id <- 4
sort(loadings[, dim_id])
loadings
# Dimension 1 vs others
plot.PCA(res_pca, choix="var", axes=c(1, 2), main="Dim 1 vs Dim 2")
plot.PCA(res_pca, choix="var", axes=c(1, 3), main="Dim 1 vs Dim 3")
plot.PCA(res_pca, choix="var", axes=c(1, 4), main="Dim 1 vs Dim 4")
# Plotting Dim 2 vs others (that haven't been plotted yet)
plot.PCA(res_pca, choix="var", axes=c(2, 3), main="Dim 2 vs Dim 3")
plot.PCA(res_pca, choix="var", axes=c(2, 4), main="Dim 2 vs Dim 4")
# Dim 3 vs Dim 4
plot.PCA(res_pca, choix="var", axes=c(3, 4), main="Dim 3 vs Dim 4")
?plot.PCA
# Dimension 1 vs others
plot.PCA(res_pca, choix="ind", axes=c(1, 2), main="Dim 1 vs Dim 2")
plot.PCA(res_pca, choix="ind", axes=c(1, 3), main="Dim 1 vs Dim 3")
plot.PCA(res_pca, choix="ind", axes=c(1, 4), main="Dim 1 vs Dim 4")
# Plotting Dim 2 vs others (that haven't been plotted yet)
plot.PCA(res_pca, choix="ind", axes=c(2, 3), main="Dim 2 vs Dim 3")
plot.PCA(res_pca, choix="ind", axes=c(2, 4), main="Dim 2 vs Dim 4")
# Finally, Dim 3 vs Dim 4
plot.PCA(res_pca, choix="ind", axes=c(3, 4), main="Dim 3 vs Dim 4")
res_pca$ind
df
df[df$player == "KOSTAS PAPANIKOLAU"]
head(df[df$player == "KOSTAS PAPANIKOLAU"])
df
df[df$player == "KOSTAS ANTETOKOUNMPO"]
df
df[df$player == "KOSTAS ANTETOKOUNMPO", ]
df[player == 'KOSTAS ANTETOKOUNMPO', ]
df$player
df$player
df$PLAYER
df[df$PLAYER == 'KOSTAS ANTETOKOUNMPO', ]
df[df$PLAYER %in% compare_players]
compare_players = c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT")
df[df$PLAYER %in% compare_players]
compare_players = c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT")
df[df$PLAYER %in% compare_players, ]
df
compare_players = c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT")
df[df$PLAYER %in% compare_players, ]
df[df$PLAYER %in% compare_players]
df[df$PLAYER == "MATHIAS LESSORT", ]
df[df$PLAYER == "MATHIAS LESSORT ", ]
df[df$PLAYER %in% compare_players, ]
compare_players = c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT ")
df[df$PLAYER %in% compare_players, ]
filter_players <- function(df, compare_players, compare_vars) {
# Clean up the player names in compare_players to match the format in the DataFrame
compare_players <- trimws(compare_players)  # Trim whitespace
# Filter the DataFrame based on the specified players and variables
filtered_df <- df[df$PLAYER %in% compare_players, compare_vars, drop = FALSE]
return(filtered_df)
}
compare_players = c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT ")
compare_vars = names(df)
filter_players(df, compare_players, compare_vars)
df
#Compare 2 close players in dimension 1 (1st plot)
filter_players(df, c("MATHIAS LESSORT ", "KONSTANTINOS MITOGLOU	", names(df)))
#Compare 2 close players in dimension 1 (1st plot)
filter_players(df, c("MATHIAS LESSORT ", "KONSTANTINOS MITOGLOU	", names(df))
#Compare 2 close players in dimension 1 (1st plot)
filter_players(df, c("MATHIAS LESSORT ", "KONSTANTINOS MITOGLOU	"), names(df))
#Compare 2 opposite players of dimension 1 (1st plot)
filter_players(df, c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT "), names(df))
#Compare 2 opposite players of dimension 1 (1st plot)
filter_players(df, c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT"), names(df))
#Compare 2 opposite players of dimension 1 (1st plot)
filter_players(df, c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT "), names(df))
filter_players <- function(df, compare_players, compare_vars) {
# Clean up the player names in compare_players to match the format in the DataFrame
#compare_players <- trimws(compare_players)  # Trim whitespace
# Filter the DataFrame based on the specified players and variables
filtered_df <- df[df$PLAYER %in% compare_players, compare_vars, drop = FALSE]
return(filtered_df)
}
#Compare 2 opposite players of dimension 1 (1st plot)
filter_players(df, c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT "), names(df))
filter_players
#Compare 2 opposite players of dimension 1 (1st plot)
filter_players(df, c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT "), names(df))
filter_players <- function(df, compare_players, compare_vars) {
# Clean up the player names in compare_players to match the format in the DataFrame
compare_players <- trimws(compare_players)  # Trim whitespace
# Filter the DataFrame based on the specified players and variables
filtered_df <- df[df$PLAYER %in% compare_players, compare_vars, drop = FALSE]
return(filtered_df)
}
#Compare 2 opposite players of dimension 1 (1st plot)
filter_players(df, c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT "), names(df))
filter_players <- function(df, compare_players, compare_vars) {
#compare_players <- trimws(compare_players)  # Trim whitespace
# Filter the DataFrame based on the specified players and variables
filtered_df <- df[df$PLAYER %in% compare_players, compare_vars, drop = FALSE]
return(filtered_df)
}
#Compare 2 opposite players of dimension 1 (1st plot)
filter_players(df, c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT "), names(df))
filter_players <- function(df, compare_players, compare_vars) {
# Clean up the player names in compare_players to match the format in the DataFrame
compare_players <- trimws(compare_players)  # Trim whitespace
# Filter the DataFrame based on the specified players and variables
filtered_df <- df[trimws(df$PLAYER) %in% compare_players, compare_vars, drop = FALSE]
return(filtered_df)
}
#Compare 2 opposite players of dimension 1 (1st plot)
filter_players(df, c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT "), names(df))
#Compare 2 opposite players of dimension 1 (1st plot)
filter_players(df, c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT"), names(df))
filter_players <- function(df, compare_players, compare_vars) {
compare_players <- trimws(compare_players)
#Trim whitespaces to avoid stupid mismatches
filtered_df <- df[trimws(df$PLAYER) %in% compare_players, compare_vars, drop = FALSE]
return(filtered_df)
}
#Compare 2 opposite players of dimension 1 (1st plot)
filter_players(df, c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT"), names(df))
#Compare 2 close players in dimension 1 (1st plot)
filter_players(df, c("MATHIAS LESSORT ", "KONSTANTINOS MITOGLOU	"), names(df))
#Compare 2 opposite players of dimension 1 (1st plot)
filter_players(df, c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT"), names(df))
#Compare 2 close players in dimension 1 (1st plot)
filter_players(df, c("MATHIAS LESSORT ", "KONSTANTINOS MITOGLOU	"), names(df))
#Compare 2 opposite players of dimension 1 (1st plot)
filter_players(df, c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT"), names(df))
#Compare 2 close players in dimension 1 (1st plot)
filter_players(df, c("MATHIAS LESSORT ", "KONSTANTINOS MITOGLOU	"), names(df))
#Compare 2 opposite players of dimension 2 (1st plot)
filter_players(df, c("MATHIAS LESSORT", "FACUNDO CAMPAZZO"), names(df))
#Compare 2 opposite players of dimension 1 (1st plot)
filter_players(df, c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT"), names(df))
#Compare 2 opposite players of dimension 2 (1st plot)
filter_players(df, c("MATHIAS LESSORT", "FACUNDO CAMPAZZO"), names(df))
(df, c("ALEC PETERS", "NIGEL HAYES-DAVIS"), names(df))
#Compare 2 opposite players of dimension 2 (1st plot)
filter_players(df, c("ALEC PETERS", "NIGEL HAYES-DAVIS"), names(df))
df
#Compare 2 close players in dimension 3 (1 vs 3 dim)
filter_players(df, c("ISMAILA DIAGNE", "ALEXANDROS SAMODUROV" ), names(df))
#Compare 2 far players in dimension 3 (1 vs 3 dim)
filter_players(df, c("MATHIAS LESSORT ", "PANAGIOTIS KALAITZAKIS"), names(df))
#Compare 2 close players in dimension 3 (1 vs 3 dim)
filter_players(df, c("ISMAILA DIAGNE", "ALEXANDROS SAMODUROV" ), names(df))
#Compare 2 close players in dimension 4 (2 vs 4 dim)
filter_players(df, c("CARLOS ALOCEN", "MICHALIS LOUNTZIS"), names(df))
#Compare 2 opposite players in dimension 4 (2 vs 4 dim)
filter_players(df, c("FACUNDO CAMPAZZO", "ALEXANDROS SAMODUROV" ), names(df))
df
#Compare 2 close players in dimension 4 (2 vs 4 dim)
filter_players(df, c("CARLOS ALOCEN", "MICHALIS LOUNTZIS"), names(df))
#Compare 2 opposite players in dimension 4 (2 vs 4 dim)
filter_players(df, c("SEHMUS HAZER", "ALEXANDROS SAMODUROV" ), names(df))
#Compare 2 close players in dimension 4 (2 vs 4 dim)
filter_players(df, c("CARLOS ALOCEN", "MICHALIS LOUNTZIS"), names(df))
?cmdscale
library("labdsv")
library("labdsv")
?pco
library(cluster)
## Open iris data set
str(iris)
daisy(iris[1:3,-5])
daisy(iris[1:3,-5],metric = "euclidean")
daisy(iris[1:3,-5],metric = "gower")
daisy(iris[1:3,-5])
daisy(iris[1:3,-5],metric = "euclidean")
daisy(df)
res_pco <- pco(df)
res_pco <- pco(daisy(df))
res_pco
######GGM
GGM_tw<- GGM(tw, prelimestimates=c(4.463368e+04, 0.001, 0.01, 1.923560e-03, 9.142022e-02))
###Libraries##################################
library(readxl)
library(DIMORA)
##############################################
setwd("/home/walterjtv/Escritorio/College/Q11/BEFD-Business-Economical-and-Financial-Data/LAB/SESSION2")
###Music data (RIAA)
music<- read_excel("music.xlsx")
str(music)
##create the variable cassette
cassette<- music$cassette[1:36]
###some simple plots
plot(cassette, type="b")
plot(cumsum(cassette), type="b")
###a better plot of the yearly time series
plot(cassette, type= "b",xlab="Year", ylab="Annual sales",  pch=16, lty=3, xaxt="n", cex=0.6)
axis(1, at=c(1,10,19,28,37), labels=music$year[c(1,10,19,28,37)])
###we estimate a simple Bass Model
bm_cass<-BM(cassette,display = T)
summary(bm_cass)
###prediction (out-of-sample)
pred_bmcas<- predict(bm_cass, newx=c(1:50))
pred.instcas<- make.instantaneous(pred_bmcas)
###plot of fitted model
plot(cassette, type= "b",xlab="Year", ylab="Annual sales",  pch=16, lty=3, xaxt="n", cex=0.6)
axis(1, at=c(1,10,19,28,37), labels=music$year[c(1,10,19,28,37)])
lines(pred.instcas, lwd=2, col=2)
bm_cass50<-BM(cassette[1:18],display = T)
summary(bm_cass50)
pred_bmcas50<- predict(bm_cass50, newx=c(1:50))
pred.instcas50<- make.instantaneous(pred_bmcas50)
plot(cassette, type= "b",xlab="Year", ylab="Annual sales",  pch=16, lty=3, xaxt="n", cex=0.6)
axis(1, at=c(1,10,19,28,37), labels=music$year[c(1,10,19,28,37)])
lines(pred.instcas50, lwd=2, col=2)
###we estimate the model with 25% of the data
bm_cass75<-BM(cassette[1:9],display = T)
summary(bm_cass75)
pred_bmcas75<- predict(bm_cass75, newx=c(1:50))
pred.instcas75<- make.instantaneous(pred_bmcas75)
###Comparison between models (instantaneous)
###instantaneous
plot(cassette, type= "b",xlab="Year", ylab="Annual sales",  pch=16, lty=3, xaxt="n", cex=0.6)
axis(1, at=c(1,10,19,28,37), labels=music$year[c(1,10,19,28,37)])
lines(pred.instcas75, lwd=2, col=2)
lines(pred.instcas50, lwd=2, col=3)
lines(pred.instcas, lwd=2, col=4)
###Comparison between models (cumulative)
plot(cumsum(cassette), type= "b",xlab="Year", ylab="Annual sales",  pch=16, lty=3, xaxt="n", cex=0.6)
axis(1, at=c(1,10,19,28,37), labels=music$year[c(1,10,19,28,37)])
lines(pred_bmcas75, lwd=2, col=2)
lines(pred_bmcas50, lwd=2, col=3)
lines(pred_bmcas, lwd=2, col=4)
music
###exercise: try the same with the CD time series
#### DIFFUSSION OF CDS HAVE A BIGGER MARKET POTENTIAL, THERE IS A BIGGER MARKET.
cds <- music[10:49,0:2]
plot(cds, type="b")
plot(cumsum(cds), type="b")
bm_cds <- BM(cds$cd, display=T)
summary(bm_cds)
pred_cds <- predict(bm_cds, newx=c(1:50))
preds_inst <- make.instantaneous(pred_cds)
plot(cds, type="b", xlab= "Year", ylab="Annual sales", pch=16, lty=3, xaxt="n", cex=0.6)
lines(preds_inst, lwd=2, col=2)
twitter<- read_excel("twitter.xlsx")
length(twitter$twitter)
plot(twitter$twitter, type= "b",xlab="Quarter", ylab="Quarterly revenues",  pch=16, lty=3, xaxt="n", cex=0.6)
axis(1, at=c(1,10,19,28,37,46), labels=twitter$quarter[c(1,10,19,28,37,46)])
###BM
tw<- (twitter$twitter)
# We want to infer trend & seasonality
# Significant autocorrelations with a increasing trend (autocorr. are ), no seasonality
# can be easily infered from the plot. We see every 4 lags the variable is significant (although its not locally higher than its neighbor values)
#
#
Acf(tw)
bm_tw<-BM(tw,display = T)
summary(bm_tw)
pred_bmtw<- predict(bm_tw, newx=c(1:60))
pred.insttw<- make.instantaneous(pred_bmtw)
plot(cumsum(tw), type= "b",xlab="Quarter", ylab="Cumulative revenues",  pch=16, lty=3, cex=0.6, xlim=c(1,60), ylim=c(0,40000))
lines(pred_bmtw, lwd=2, col=2)
# Judging from this plot
#
plot(tw, type= "b",xlab="Quarter", ylab="Quarterly revenues",  pch=16, lty=3, cex=0.6, xlim=c(1,60))
lines(pred.insttw, lwd=2, col=2)
# As preliminary estimates we use the values of the previous normal bass model
# Its a reasonable choice of initial estimates because they were estimated by the data and
# because the bass model is a nested model inside of GBM. (n, p ,q)
GBMr1tw<- GBM(tw,shock = "rett",nshock = 1,prelimestimates = c(4.463368e+04, 1.923560e-03, 9.142022e-02, 24,38,-0.1))
# As preliminary estimates we use the values of the previous normal bass model
# Its a reasonable choice of initial estimates because they were estimated by the data and
# because the bass model is a nested model inside of GBM. (n, p ,q)
GBMr1tw<- GBM(tw,shock = "rett",nshock = 1,prelimestimates = c(4.463368e+04, 1.923560e-03, 9.142022e-02, 24,38,-0.1))
# As preliminary estimates we use the values of the previous normal bass model
# Its a reasonable choice of initial estimates because they were estimated by the data and
# because the bass model is a nested model inside of GBM. (n, p ,q)
GBMr1tw<- GBM(tw,shock = "rett",nshock = 1,prelimestimates = c(4.463368e+04, 1.923560e-03, 9.142022e-02, 24,38,-0.1))
# As preliminary estimates we use the values of the previous normal bass model
# Its a reasonable choice of initial estimates because they were estimated by the data and
# because the bass model is a nested model inside of GBM. (n, p ,q)
GBMr1tw<- GBM(tw,shock = "rett",nshock = 1,prelimestimates = c(4.463368e+04, 1.923560e-03, 9.142022e-02, 24,38,-0.1))
# As preliminary estimates we use the values of the previous normal bass model
# Its a reasonable choice of initial estimates because they were estimated by the data and
# because the bass model is a nested model inside of GBM. (n, p ,q)
GBMr1tw<- GBM(tw,shock = "rett",nshock = 1,prelimestimates = c(4.463368e+04, 1.923560e-03, 9.142022e-02, 24,38,-0.1))
GBMe1tw<- GBM(tw,shock = "exp",nshock = 1,prelimestimates = c(4.463368e+04, 1.923560e-03, 9.142022e-02, 12,-0.1,0.1))
summary(GBMe1tw)
pred_GBMe1tw<- predict(GBMe1tw, newx=c(1:60))
pred_GBMe1tw.inst<- make.instantaneous(pred_GBMe1tw)
plot(cumsum(tw), type= "b",xlab="Quarter", ylab="Cumulative revenues",  pch=16, lty=3, cex=0.6, xlim=c(1,60), ylim=c(0,50000))
lines(pred_GBMe1tw, lwd=2, col=2)
plot(tw, type= "b",xlab="Quarter", ylab="Quarterly revenues",  pch=16, lty=3, cex=0.6, xlim=c(1,60))
lines(pred_GBMe1tw.inst, lwd=2, col=2)
######GGM
GGM_tw<- GGM(tw, prelimestimates=c(4.463368e+04, 0.001, 0.01, 1.923560e-03, 9.142022e-02))
######GGM 2 processes
# COMMUNICATION: We need to estimate the initial values (magnitude like learning rate) of p_c, q_c usually 1/100 ratio
# SELLING: A good initial estimate is to simply pick the previously estimated parameters of the regular BASS MODEL
#
GGM_tw<- GGM(tw, prelimestimates=c(4.463368e+04, 0.001, 0.01, 1.923560e-03, 9.142022e-02))
summary(GGM_tw)
pred_GGM_tw<- predict(GGM_tw, newx=c(1:60))
pred_GGM_tw.inst<- make.instantaneous(pred_GGM_tw)
plot(cumsum(tw), type= "b",xlab="Quarter", ylab="Cumulative revenues",  pch=16, lty=3, cex=0.6, xlim=c(1,60), ylim=c(0,40000))
lines(pred_bmtw, lwd=2, col=2)
# Judging from this plot
plot(tw, type= "b",xlab="Quarter", ylab="Quarterly revenues",  pch=16, lty=3, cex=0.6, xlim=c(1,60))
lines(pred.insttw, lwd=2, col=2)
# As preliminary estimates we use the values of the previous normal bass model
# Its a reasonable choice of initial estimates because they were estimated by the data and
# because the bass model is a nested model inside of GBM. (n, p ,q)
GBMr1tw<- GBM(tw,shock = "rett",nshock = 1,prelimestimates = c(4.463368e+04, 1.923560e-03, 9.142022e-02, 24,38,-0.1))
GBMe1tw<- GBM(tw,shock = "exp",nshock = 1,prelimestimates = c(4.463368e+04, 1.923560e-03, 9.142022e-02, 12,-0.1,0.1))
summary(GBMe1tw)
GBMe1tw<- GBM(tw,shock = "exp",nshock = 1,prelimestimates = c(4.463368e+04, 1.923560e-03, 9.142022e-02, 12,-0.1,0.1))
summary(GBMe1tw)
pred_GBMe1tw<- predict(GBMe1tw, newx=c(1:60))
pred_GBMe1tw.inst<- make.instantaneous(pred_GBMe1tw)
plot(cumsum(tw), type= "b",xlab="Quarter", ylab="Cumulative revenues",  pch=16, lty=3, cex=0.6, xlim=c(1,60), ylim=c(0,50000))
lines(pred_GBMe1tw, lwd=2, col=2)
plot(tw, type= "b",xlab="Quarter", ylab="Quarterly revenues",  pch=16, lty=3, cex=0.6, xlim=c(1,60))
lines(pred_GBMe1tw.inst, lwd=2, col=2)
######GGM 2 processes
# COMMUNICATION: We need to estimate the initial values (magnitude like learning rate) of p_c, q_c usually 1/100 ratio
# SELLING: A good initial estimate is to simply pick the previously estimated parameters of the regular BASS MODEL
GGM_tw<- GGM(tw, prelimestimates=c(4.463368e+04, 0.001, 0.01, 1.923560e-03, 9.142022e-02))
summary(GGM_tw)
pred_GGM_tw<- predict(GGM_tw, newx=c(1:60))
pred_GGM_tw.inst<- make.instantaneous(pred_GGM_tw)
plot(tw, type= "b",xlab="Quarter", ylab="Quarterly revenues",  pch=16, lty=3, cex=0.6, xlim=c(1,60))
lines(pred_GGM_tw.inst, lwd=2, col=2)
###Analysis of residuals
res_GGMtw<- residuals(GGM_tw)
acf<- acf(residuals(GGM_tw))
plot(res_GGMtw)
##read the data
bp<- read_excel("BP1.xlsx")
str(bp)
str(bp)
###we consider coal, nuclear and renewables
GC<- bp$GermanyC[1:55]
GN<- bp$GermanyN[1:55]
GR<- bp$GermanyR[28:55]
plot(GC, type= "b",xlab="Year", ylab="Annual consumption",  pch=16, lty=3, xaxt="n", cex=0.6)
axis(1, at=c(1,10,19,28,37,46,55), labels=bp$year[c(1,10,19,28,37,46,55)])
plot(GC, type= "b",xlab="Year", ylab="Annual consumption",  pch=16, lty=3, xaxt="n", cex=0.6)
axis(1, at=c(1,10,19,28,37,46,55), labels=bp$year[c(1,10,19,28,37,46,55)])
plot(GN, type= "b",xlab="Year", ylab="Annual consumption",  pch=16, lty=3, xaxt="n", cex=0.6)
axis(1, at=c(1,10,19,28,37,46,55), labels=bp$year[c(1,10,19,28,37,46,55)])
plot(GR, type= "b",xlab="Year", ylab="Annual consumption",  pch=16, lty=3, xaxt="n", cex=0.6)
axis(1, at=c(1,10,19,28,37), labels=bp$year[28:56][c(1,10,19,28,37)])
##BM
bm_GC<-BM(GC,display = T)
summary(bm_GC)
pred_bmGC<- predict(bm_GC, newx=c(1:60))
pred.instGC<- make.instantaneous(pred_bmGC)
plot(GC, type= "b",xlab="Year", ylab="Annual consumption",  pch=16, lty=3, xaxt="n", cex=0.6)
axis(1, at=c(1,10,19,28,37,46,55), labels=bp$year[c(1,10,19,28,37,46,55)])
lines(pred.instGC, lwd=2, col=2)
bm_GN<-BM(GN,display = T)
summary(bm_GN)
pred_bmGN<- predict(bm_GN, newx=c(1:60))
pred.instGN<- make.instantaneous(pred_bmGN)
plot(GN, type= "b",xlab="Year", ylab="Annual consumption",  pch=16, lty=3, xaxt="n", cex=0.6, ylim=c(0,2))
axis(1, at=c(1,10,19,28,37,46,55), labels=bp$year[c(1,10,19,28,37,46,55)])
lines(pred.instGN, lwd=2, col=2)
GGM_GN<- GGM(GN, prelimestimates=c(56.339566617, 0.001, 0.01, 0.001481412, 0.129385437))
summary(GGM_GN)
pred_GGMGN<- predict(GGM_GN, newx=c(1:60))
pred.instGGMGN<- make.instantaneous(pred_GGMGN)
plot(GN, type= "b",xlab="Year", ylab="Annual consumption",  pch=16, lty=3, xaxt="n", cex=0.6)
axis(1, at=c(1,10,19,28,37,46,55), labels=bp$year[c(1,10,19,28,37,46,55)])
lines(pred.instGGMGN, lwd=2, col=2)
pred_GGMGN<- predict(GGM_GN, newx=c(1:60))
pred.instGGMGN<- make.instantaneous(pred_GGMGN)
plot(GN, type= "b",xlab="Year", ylab="Annual consumption",  pch=16, lty=3, xaxt="n", cex=0.6)
axis(1, at=c(1,10,19,28,37,46,55), labels=bp$year[c(1,10,19,28,37,46,55)])
bm_GR<-BM(GR,display = T)
summary(bm_GR)
pred_bmGR<- predict(bm_GR, newx=c(1:60))
pred.instGR<- make.instantaneous(pred_bmGR)
plot(GR, type= "b",xlab="Year", ylab="Annual consumption",  pch=16, lty=3, xaxt="n", cex=0.6)
axis(1, at=c(1,10,19,28,37), labels=bp$year[28:56][c(1,10,19,28,37)])
lines(pred.instGR, lwd=2, col=1)
GBMe1GR<- GBM(GR,shock = "exp",nshock = 1,prelimestimates = c(3.250461e+01, 5.708759e-04, 1.914512e-01, 15,-0.1,0.1))
summary(GBMe1GR)
pred_GBMe1GR<- predict(GBMe1GR, newx=c(1:60))
pred.instGBMe1GR<- make.instantaneous(pred_GBMe1GR)
plot(GR, type= "b",xlab="Year", ylab="Annual consumption",  pch=16, lty=3, xaxt="n", cex=0.6)
axis(1, at=c(1,10,19,28,37), labels=bp$year[28:56][c(1,10,19,28,37)])
lines(pred.instGBMe1GR, lwd=2, col=1)
plot(GR, type= "b",xlab="Year", ylab="Annual consumption",  pch=16, lty=3, cex=0.6, xlim=c(1,60), ylim=c(0,3))
lines(pred.instGBMe1GR, lwd=2, col=2)
lines(pred.instGR, lwd=2, col=3)
GBMe1GR<- GBM(GR,shock = "exp",nshock = 1,prelimestimates = c(3.250461e+01, 5.708759e-04, 1.914512e-01, 15,-0.1,0.1))
summary(GBMe1GR)
pred_GBMe1GR<- predict(GBMe1GR, newx=c(1:60))
pred.instGBMe1GR<- make.instantaneous(pred_GBMe1GR)
plot(GR, type= "b",xlab="Year", ylab="Annual consumption",  pch=16, lty=3, xaxt="n", cex=0.6)
axis(1, at=c(1,10,19,28,37), labels=bp$year[28:56][c(1,10,19,28,37)])
lines(pred.instGBMe1GR, lwd=2, col=1)
