x = 2
y = 32
x + y
# Dimension 1 vs others
plot.PCA(res_pca, choix="ind", axes=c(1, 2), main="Dim 1 vs Dim 2")
rm(list=ls())
euroleague_23_24 <- read.csv2("euroleague_23_24.csv")
df <- euroleague_23_24[,-1]
min_column = df[,6]
min_column_splited = strsplit(min_column,split=':',fixed=TRUE)
aux <- sapply(min_column_splited, function(x) {
as.numeric(x[1]) * 60 + as.numeric(x[2]) + as.numeric(x[3]) / 60
})
df<- data.frame(Aux = aux, df[,])
# No acabo de entendre si un cop afegit la columna aux s'ha de borra la columna antiga de MIN
games_played <- df[,5]
min2 <- aux/games_played
df <- data.frame(df[,1], Min2 = min2, df[,-1])
str(df)
df$TEAM <- as.factor(df$TEAM)
df$PLAYER<- as.factor(df$PLAYER)
df$POSITION <- as.factor(df$POSITION)
df$GP <- as.numeric(df$GP)
df$GS <- as.numeric(df$GS)
df <- df[,-8] # I delete the column of Min with a String format
str(df)
library(FactoMineR)
categ_vars <- c("TEAM", "PLAYER", "POSITION")
res_pca <- PCA(df, scale.unit = TRUE, graph=FALSE,
quali.sup = which(names(df) %in% categ_vars),
quanti.sup = which(names(df) == "PIR"))
plot(res_pca)
#See eigenvalues great than 1
res_pca$eig
which(res_pca$eig[,1] > 1)
#How many components are needed for 67%?
which(res_pca$eig[,3] > 67)[1]
#How many components are needed for 80%?
which(res_pca$eig[,3] > 80)[1]
#Compute Scree plot
plot(res_pca$eig[,2], type="o", main="Scree Plot: Percentage of Variance by Component", xlab="Number of components", ylab="Percentage of variance", col="blue", pch=16, xaxt="n", yaxt="n")
axis(1, at=1:length(res_pca$eig[,2]), labels=1:length(res_pca$eig[,2]), las=1)
axis(2, las=1)
loadings <- res_pca$var$coord
dim_id <- 4
sort(loadings[, dim_id])
loadings
# Dimension 1 vs others
plot.PCA(res_pca, choix="var", axes=c(1, 2), main="Dim 1 vs Dim 2")
plot.PCA(res_pca, choix="var", axes=c(1, 3), main="Dim 1 vs Dim 3")
plot.PCA(res_pca, choix="var", axes=c(1, 4), main="Dim 1 vs Dim 4")
# Plotting Dim 2 vs others (that haven't been plotted yet)
plot.PCA(res_pca, choix="var", axes=c(2, 3), main="Dim 2 vs Dim 3")
plot.PCA(res_pca, choix="var", axes=c(2, 4), main="Dim 2 vs Dim 4")
# Dim 3 vs Dim 4
plot.PCA(res_pca, choix="var", axes=c(3, 4), main="Dim 3 vs Dim 4")
?plot.PCA
# Dimension 1 vs others
plot.PCA(res_pca, choix="ind", axes=c(1, 2), main="Dim 1 vs Dim 2")
plot.PCA(res_pca, choix="ind", axes=c(1, 3), main="Dim 1 vs Dim 3")
plot.PCA(res_pca, choix="ind", axes=c(1, 4), main="Dim 1 vs Dim 4")
# Plotting Dim 2 vs others (that haven't been plotted yet)
plot.PCA(res_pca, choix="ind", axes=c(2, 3), main="Dim 2 vs Dim 3")
plot.PCA(res_pca, choix="ind", axes=c(2, 4), main="Dim 2 vs Dim 4")
# Finally, Dim 3 vs Dim 4
plot.PCA(res_pca, choix="ind", axes=c(3, 4), main="Dim 3 vs Dim 4")
res_pca$ind
df
df[df$player == "KOSTAS PAPANIKOLAU"]
head(df[df$player == "KOSTAS PAPANIKOLAU"])
df
df[df$player == "KOSTAS ANTETOKOUNMPO"]
df
df[df$player == "KOSTAS ANTETOKOUNMPO", ]
df[player == 'KOSTAS ANTETOKOUNMPO', ]
df$player
df$player
df$PLAYER
df[df$PLAYER == 'KOSTAS ANTETOKOUNMPO', ]
df[df$PLAYER %in% compare_players]
compare_players = c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT")
df[df$PLAYER %in% compare_players]
compare_players = c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT")
df[df$PLAYER %in% compare_players, ]
df
compare_players = c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT")
df[df$PLAYER %in% compare_players, ]
df[df$PLAYER %in% compare_players]
df[df$PLAYER == "MATHIAS LESSORT", ]
df[df$PLAYER == "MATHIAS LESSORT ", ]
df[df$PLAYER %in% compare_players, ]
compare_players = c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT ")
df[df$PLAYER %in% compare_players, ]
filter_players <- function(df, compare_players, compare_vars) {
# Clean up the player names in compare_players to match the format in the DataFrame
compare_players <- trimws(compare_players)  # Trim whitespace
# Filter the DataFrame based on the specified players and variables
filtered_df <- df[df$PLAYER %in% compare_players, compare_vars, drop = FALSE]
return(filtered_df)
}
compare_players = c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT ")
compare_vars = names(df)
filter_players(df, compare_players, compare_vars)
df
#Compare 2 close players in dimension 1 (1st plot)
filter_players(df, c("MATHIAS LESSORT ", "KONSTANTINOS MITOGLOU	", names(df)))
#Compare 2 close players in dimension 1 (1st plot)
filter_players(df, c("MATHIAS LESSORT ", "KONSTANTINOS MITOGLOU	", names(df))
#Compare 2 close players in dimension 1 (1st plot)
filter_players(df, c("MATHIAS LESSORT ", "KONSTANTINOS MITOGLOU	"), names(df))
#Compare 2 opposite players of dimension 1 (1st plot)
filter_players(df, c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT "), names(df))
#Compare 2 opposite players of dimension 1 (1st plot)
filter_players(df, c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT"), names(df))
#Compare 2 opposite players of dimension 1 (1st plot)
filter_players(df, c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT "), names(df))
filter_players <- function(df, compare_players, compare_vars) {
# Clean up the player names in compare_players to match the format in the DataFrame
#compare_players <- trimws(compare_players)  # Trim whitespace
# Filter the DataFrame based on the specified players and variables
filtered_df <- df[df$PLAYER %in% compare_players, compare_vars, drop = FALSE]
return(filtered_df)
}
#Compare 2 opposite players of dimension 1 (1st plot)
filter_players(df, c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT "), names(df))
filter_players
#Compare 2 opposite players of dimension 1 (1st plot)
filter_players(df, c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT "), names(df))
filter_players <- function(df, compare_players, compare_vars) {
# Clean up the player names in compare_players to match the format in the DataFrame
compare_players <- trimws(compare_players)  # Trim whitespace
# Filter the DataFrame based on the specified players and variables
filtered_df <- df[df$PLAYER %in% compare_players, compare_vars, drop = FALSE]
return(filtered_df)
}
#Compare 2 opposite players of dimension 1 (1st plot)
filter_players(df, c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT "), names(df))
filter_players <- function(df, compare_players, compare_vars) {
#compare_players <- trimws(compare_players)  # Trim whitespace
# Filter the DataFrame based on the specified players and variables
filtered_df <- df[df$PLAYER %in% compare_players, compare_vars, drop = FALSE]
return(filtered_df)
}
#Compare 2 opposite players of dimension 1 (1st plot)
filter_players(df, c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT "), names(df))
filter_players <- function(df, compare_players, compare_vars) {
# Clean up the player names in compare_players to match the format in the DataFrame
compare_players <- trimws(compare_players)  # Trim whitespace
# Filter the DataFrame based on the specified players and variables
filtered_df <- df[trimws(df$PLAYER) %in% compare_players, compare_vars, drop = FALSE]
return(filtered_df)
}
#Compare 2 opposite players of dimension 1 (1st plot)
filter_players(df, c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT "), names(df))
#Compare 2 opposite players of dimension 1 (1st plot)
filter_players(df, c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT"), names(df))
filter_players <- function(df, compare_players, compare_vars) {
compare_players <- trimws(compare_players)
#Trim whitespaces to avoid stupid mismatches
filtered_df <- df[trimws(df$PLAYER) %in% compare_players, compare_vars, drop = FALSE]
return(filtered_df)
}
#Compare 2 opposite players of dimension 1 (1st plot)
filter_players(df, c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT"), names(df))
#Compare 2 close players in dimension 1 (1st plot)
filter_players(df, c("MATHIAS LESSORT ", "KONSTANTINOS MITOGLOU	"), names(df))
#Compare 2 opposite players of dimension 1 (1st plot)
filter_players(df, c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT"), names(df))
#Compare 2 close players in dimension 1 (1st plot)
filter_players(df, c("MATHIAS LESSORT ", "KONSTANTINOS MITOGLOU	"), names(df))
#Compare 2 opposite players of dimension 1 (1st plot)
filter_players(df, c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT"), names(df))
#Compare 2 close players in dimension 1 (1st plot)
filter_players(df, c("MATHIAS LESSORT ", "KONSTANTINOS MITOGLOU	"), names(df))
#Compare 2 opposite players of dimension 2 (1st plot)
filter_players(df, c("MATHIAS LESSORT", "FACUNDO CAMPAZZO"), names(df))
#Compare 2 opposite players of dimension 1 (1st plot)
filter_players(df, c("KOSTAS ANTETOKOUNMPO", "MATHIAS LESSORT"), names(df))
#Compare 2 opposite players of dimension 2 (1st plot)
filter_players(df, c("MATHIAS LESSORT", "FACUNDO CAMPAZZO"), names(df))
(df, c("ALEC PETERS", "NIGEL HAYES-DAVIS"), names(df))
#Compare 2 opposite players of dimension 2 (1st plot)
filter_players(df, c("ALEC PETERS", "NIGEL HAYES-DAVIS"), names(df))
df
#Compare 2 close players in dimension 3 (1 vs 3 dim)
filter_players(df, c("ISMAILA DIAGNE", "ALEXANDROS SAMODUROV" ), names(df))
#Compare 2 far players in dimension 3 (1 vs 3 dim)
filter_players(df, c("MATHIAS LESSORT ", "PANAGIOTIS KALAITZAKIS"), names(df))
#Compare 2 close players in dimension 3 (1 vs 3 dim)
filter_players(df, c("ISMAILA DIAGNE", "ALEXANDROS SAMODUROV" ), names(df))
#Compare 2 close players in dimension 4 (2 vs 4 dim)
filter_players(df, c("CARLOS ALOCEN", "MICHALIS LOUNTZIS"), names(df))
#Compare 2 opposite players in dimension 4 (2 vs 4 dim)
filter_players(df, c("FACUNDO CAMPAZZO", "ALEXANDROS SAMODUROV" ), names(df))
df
#Compare 2 close players in dimension 4 (2 vs 4 dim)
filter_players(df, c("CARLOS ALOCEN", "MICHALIS LOUNTZIS"), names(df))
#Compare 2 opposite players in dimension 4 (2 vs 4 dim)
filter_players(df, c("SEHMUS HAZER", "ALEXANDROS SAMODUROV" ), names(df))
#Compare 2 close players in dimension 4 (2 vs 4 dim)
filter_players(df, c("CARLOS ALOCEN", "MICHALIS LOUNTZIS"), names(df))
?cmdscale
library("labdsv")
library("labdsv")
?pco
library(cluster)
## Open iris data set
str(iris)
daisy(iris[1:3,-5])
daisy(iris[1:3,-5],metric = "euclidean")
daisy(iris[1:3,-5],metric = "gower")
daisy(iris[1:3,-5])
daisy(iris[1:3,-5],metric = "euclidean")
daisy(df)
res_pco <- pco(df)
res_pco <- pco(daisy(df))
res_pco
####Lab 1: Linear regression with time series data####
###Libraries##################################
library(readxl)
library(lmtest)
library(forecast)
install.packages("forecast")
install.packages("forecast")
install.packages("fpp2")
library(forecast)
library(fpp2)
##some plots for time series##################
plot(a10, ylab="million dollars", xlab="Year", main="Antidiabetic drugs")
tsdisplay(a10) ##a general view of the data
seasonplot(a10, ylab="million dollars", xlab="Year", main="Seasonal plot: Antidiabetic drugs", year.labels=T, year.labels.left=T, col=1:20, pch=19)
###read the data
facebook<- read_excel("facebook.xlsx")
###read the data
print(cwd)
getcwd()
getwd()
ls
###read the data
setwd("/home/walterjtv/Escritorio/College/Q11/BEFD-Business-Economical-and-Financial-Data/LAB")
facebook<- read_excel("facebook.xlsx")
ls()
###read the data
setwd("/home/walterjtv/Escritorio/College/Q11/BEFD-Business-Economical-and-Financial-Data/LAB/")
ls(getwd())
getwd()
###read the data
setwd("/home/walterjtv/Escritorio/College/Q11/BEFD-Business-Economical-and-Financial-Data/LAB/SESSION1")
facebook<- read_excel("facebook.xlsx")
str(facebook)
##create a variable 'time'
tt<- 1:NROW(facebook)
#create the variable 'fb'
fb <- facebook$fb
##make a plot
plot(tt, fb, xlab="Time", ylab="Facebook users")
acf(fb)
##acf of variable "fb"
acf(fb)
##fit a linear regression model
fit1 <- lm(fb~ tt)
summary(fit1)
library(ISLR2)
install.packages("ISLR2")
##fit a linear regression model
fit1 <- lm(fb~ tt)
summary(fit1)
anova(fit1)
##plot of the model
plot(tt, fb, xlab="Time", ylab="Facebook users")
abline(fit1, col=3)
##check the residuals? are they autocorrelated? Test of DW
dwtest(fit1)
##check the residuals
resfit1<- residuals(fit1)
plot(resfit1,xlab="Time", ylab="residuals" )
##we can do the same with a linear model for time series, so we transform the data into a 'ts' object
fb.ts <- ts(fb, frequency = 4)
ts.plot(fb.ts, type="o")
## we fit a linear model with the tslm function
fitts<- tslm(fb.ts~trend)
## we fit a linear model with the tslm function
fitts<- tslm(fb.ts~trend)
###obviously, it gives the same results as the first model
summary(fitts)
dwtest(fitts)
apple<- read_excel("apple.xlsx")
# linear model
fit2 <- lm(imac~tt)
##we can do the same with a linear model for time series, so we transform the data into a 'ts' object
fb.ts <- ts(fb, frequency = 4)
fb.ts
## we fit a linear model with the tslm function
fitts<- tslm(fb.ts~trend + season)
###obviously, it gives the same results as the first model
summary(fitts)
dwtest(fitts)
apple<- read_excel("apple.xlsx")
str(apple)
imac <- apple$iMac
#data visualization
plot(imac,type="l", xlab="quarter", ylab="iMac sales")
#variable tt for a linear model
tt<- 1:NROW(apple)
# linear model
fit2 <- lm(imac~tt)
summary(fit2)
abline(fit2, col=3)
# Durbin-Watson test
dwtest(fit2)
beer<- ausbeer
beer
plot(beer)
Acf(beer)
plot(beer)
Acf(beer)
#take a portion of data and fit a linear model with tslm
beer1<- window(ausbeer, start=1992, end=2006 -.1)
beer1
plot(beer1)
plot(beer1)
plot(beer1)
m1<- tslm(beer1~ trend+ season)
summary(m1)
fit<- fitted(m1)
plot(beer1)
plot(beer1)
fit<- fitted(m1)
plot(beer1)
lines(fitted(m1), col=2)
fore <- forecast(m1)
plot(fore)
#analysis of residuals
res<- residuals(m1)
plot(res)
# There are autocorrelations in the data!
#the form of residuals seems to indicate the presence of negative autocorrelation
Acf(res)
